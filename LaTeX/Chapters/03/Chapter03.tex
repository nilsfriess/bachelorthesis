\chapter{Complex Rayleigh Quotient Iteration}
In this chapter we introduce \emph{Complex Rayleigh Quotient
  Iteration} (CRQI\footnote{We abbreviate the classic Rayleigh
  Quotient Iteration that was discussed in the previous chapter by
  \emph{RQI} or \emph{classic RQI} and the method introduced in this
  chapter by \emph{CRQI}.}). This is a novel shift-and-invert
algorithm similar to classic RQI. Numerical experiments suggest that
this new method overcomes some of the disadvantages of classic RQI.
In particular, it seems to perform well in cases when there are
eigenvalues very close to the target eigenvalue but a good
approximation of the eigenvector is known.

\input{Chapters/03/Motivation}
\input{Chapters/03/NumericalExperiments}

% Immediately, the following result follows.

% \begin{corollary}
%   Algorithm~\ref{alg:crqi:proj} produces the same results when
%   $\tilde{\mat{A}}$ is replaced with
%   $\hat{\mat{A}} = \mat{A} + i \gamma \mat{I}$.
% \end{corollary}
% \begin{proof}
  
% \end{proof}
% This result allows for a simplification of the algorithm. We combine
% the real shift $\mu^{(k)}$ and the imaginary shift $i \gamma^{(k)}$
% into a new shift $\sigma^{(k)} \coloneqq \mu^{(k)} - i \gamma^{(k)}$
% and solve the system
% \begin{equation*}
%   (\mat{A} - \sigma^{(k)} \mat{I}) \vec{x}^{(k+1)} = \vec{x}^{(k)}
% \end{equation*}
% for $\vec{x}^{(k+1)}$ at each step.



% Although we will soon slightly change the matrix $\tilde{\mat{A}}$
% defined in~\eqref{eq:a:tilde} again, we summarise the discussion up
% to this point in Algorithm~\ref{alg:crqi:proj}.\footnote{By
% $\Re(\vec{x})$ we denote the real part of the complex vector
% $\vec{x}$.}

% \begin{algorithm}[htpb]
%   \DontPrintSemicolon
%   \KwData{Nonzero initial vector $\vec{x}^{(0)}$ with $\norm*{\vec{x}^{(0)}} = 1$}
%   \Begin{
%     $\mu^{(0)} \gets {(\vec{x}^{(0)})}^\herm \mat{A} \vec{x}^{(0)}$\;
%     $r^{(0)} \gets \norm*{(\mat{A} - \mu^{(0)}\mat{I}) \vec{x}^{(0)}}$\;
%     $\gamma^{(0)} \gets r^{(0)}$\;
%     \For{$k = 1,2,\dotsc$ until convergence}{
%       $\tilde{\mat{A}} \gets \mat{A} - \gamma^{(k)}i(\mat{I} - \vec{x}^{(k)} {(\vec{x}^{(k)})}^\herm)$\;
%       Solve $( \tilde{\mat{A}} - \mu^{(k)}\mat{I})\tilde{\vec{x}}^{(k+1)} = \vec{x}^{(k)}$\;
%       $\vec{x}^{(k+1)} \gets \tilde{\vec{x}}^{(k+1)} / \norm*{\tilde{\vec{x}}^{(k+1)}}$\;
%       $\mu^{(k+1)} \gets {(\vec{x}^{(k+1)})}^\herm \mat{A} \vec{x}^{(k+1)}$\;
%       $r^{(k+1)} \gets \norm*{(\mat{A} - \mu^{(k+1)}\mat{I}) \vec{x}^{(k+1)}}$\;
%       $\gamma^{(k+1)} \gets r^{(k+1)}$\;
%     }
%     $\vec{x} \gets \Re({\vec{x}^{(k+1)}})$\;
%     $\vec{x} \gets \vec{x} / \norm*{\vec{x}}$
%   }
%   \caption{Complex Rayleigh Quotient Iteration, First Version}\label{alg:crqi:proj}
% \end{algorithm}
% \todo{Sign of shift in Algo step should be +?}

% Strictly speaking, this algorithm is not a Rayleigh Quotient
% Iteration as the matrix changes at each step. Obviously, the method
% is strongly linked to RQI so we still refer to it as Complex
% Rayleigh Quotient Iteration. As mentioned above, this is not the
% final version as we wish to present it. The following lemma allows
% for a small simplification of the algorithm.

% used as an initial guess in the classic Rayleigh Quotient Iteration.
% We can, however, use~\eqref{eq:guess_orthogonal} to shift the
% eigenvalues in such a way that the distance between the target
% eigenvalue and adjacent eigenvalues is increased. This fact is then
% used to alter the linear system that is solved at each step in the
% Rayleigh Quotient Iteration, increasing the chance that the method
% will converge to the right eigenpair.

% We first observe that given a vector $\vec{x} \in \R^n$, the
% projection of $\vec{x} \in \R^n$ onto the span of a unit vector
% $\vec{u}$ is
% \[
%   (\vec{u}^\tp \vec{x})\vec{u} = \vec{u}(\vec{u}^\tp
%   \vec{x})=(\vec{u} \vec{u}^\tp) \vec{x}\,,
% \]
% Thus, the projection onto the orthogonal complement of the span of
% $\vec{u}$ is
% \[
%   \vec{x} - (\vec{u}^\tp \vec{x}) \vec{u} = \vec{x} - (\vec{u}
%   \vec{u}^\tp) \vec{x} = (\mat{I} - \vec{u} \vec{u}^\tp) \vec{x} \,.
% \]
% Consider the matrix
% $\tilde{\mat{A}} \coloneqq \mat{A} - i \gamma ( \mat{I} - \vec{u}
% \vec{u}^\tp)$ where $\gamma > 0$ is an arbitrary real number and $i$
% denotes the imaginary unit. Multiplying this matrix with an
% eigenvector of $\mat{A}$ gives
% \begin{align*}
%   \tilde{\mat{A}}\vec{v}_j &= \left( \mat{A} - i \gamma ( \mat{I}
%   %     - \vec{v}_k
%   %     \vec{v}_k^\tp) \right) \vec{v}_j \\
%   %   &= \mat{A} \vec{v}_j - i \gamma \vec{v}_j + i \gamma \vec{v}_k
%   %   \vec{v}_k^\tp \vec{v}_j \\
%   %   &= (\lambda_j - i \gamma)\vec{v}_j + i \gamma \delta_{kj}
%   %   \vec{v}_k \,,
% \end{align*}
% where $\delta_{kj}$ denotes the Kronecker delta. In other words, if
% $j \neq k$ we have
% \[
%   \tilde{\mat{A}} \vec{v}_j = (\lambda_j - i \gamma)\vec{v}_j
% \]
% and if $j = k$ we have
% \[
%   \tilde{\mat{A}} \vec{v}_j = \tilde{\mat{A}} \vec{v}_k = (\lambda_k
%   - i \gamma) \vec{v}_k - i \gamma \vec{u} = \lambda_k \vec{v}_k \,.
% \]
% We can conclude that $\tilde{\mat{A}}$ has the same set of
% eigenvectors as $\mat{A}$ with corresponding eigenvalues
% $\lambda_j - i \gamma$ if $j \neq k$ and $\lambda_j$ if $j = k$. In
% other words, we ``raised'' all eigenvalues corresponding to
% eigenvectors that are orthogonal to $\vec{u}$ from the real line
% into the complex plane such that their imaginary parts are equal to
% $\gamma$ increasing the distance \wrt the Euclidean norm between the
% eigenvalues.

% Note, however, that $\vec{u}$ is an eigenvector of $\mat{A}$. We
% will shortly use this approach to guarantee convergence to the
% target eigenvector using a Rayleigh Quotient type Iteration. Of
% course, we will merely have an approximation of an eigenvector so
% that~\eqref{eq:guess_orthogonal} holds. However, as the observations
% above suggest, this approach also works for such
% approximations. This is due to the fact that vectors that lie in the
% orthogonal complement of the span of an approximate eigenvector are
% themselves approximate eigenvectors. The eigenvalues are then raised
% according to the angle between the corresponding eigenvector and the
% subspace defined by the orthogonal projection of the span of
% $\vec{u}$ (see the Lemma below).  Thus, the target eigenvalue (\ie
% the eigenvalue corresponding to the eigenvector closest to
% $\vec{u}$) is barely raised.


% \begin{lemma}\label{lem:eig:orthogprojection}
%   Define the matrix
%   $\tilde{\mat{A}} \coloneqq \mat{A} - i \gamma (\mat{I} -
%   \vec{u}\vec{u}^\tp)$.
% \end{lemma}

% \begin{corollary}
%   The Rayleigh sequences generated using the matrices $\mat{B}$ and
%   $\mat{C}$ as in~\eqref{eq:rayleigh_quotient_complex}
%   and~\eqref{eq:rayleigh_quotient_proj}, respectively, are the same.
% \end{corollary}

% \section{Preconditioners for the Complex Symmetric System}

% \section{Numerical Examples}
% \subsection{Preconditioned Large Sparse System}


%%% Local Variables:
%%% mode: latex 
%%% TeX-master: "../../main"
%%% End:
 