\documentclass[mathserif]{beamer}

%\usepackage{pgfpages}
%\setbeameroption{show notes on second screen=bottom} % Both

\input{preamble}
\input{mathsetup}

\usepackage{setspace}

\usepackage{tikz}

\title{Using Complex Shifts in Rayleigh Quotient Iteration to Compute Close Eigenvalues}
\author{{Nils Friess}}
\titlegraphic{\vspace{1cm}\includegraphics[height = 0.23 \textheight]{unihei_logo_4c.eps}}
\date{\today}

\begin{document}
{
\setbeamertemplate{footline}{}
\setbeamertemplate{headline}{} 
\begin{frame}
  \titlepage%
  
  \note{Welcome etc. Self contained, but feel free to interrupt and ask questions if anything is unclear.}
\end{frame}
}

\newcommand{\tc}[1]{\raisebox{.5pt}{\textcircled{\raisebox{-.9pt}
      {#1}}}} \addtocounter{framenumber}{-1} {
  \setbeamertemplate{headline}{}
  \begin{frame}
    \frametitle{Contents}
    \begin{itemize}\setlength\itemsep{2em}
    \item Using Complex Shifts
    \item in Rayleigh Quotient Iteration
    \item to Compute Close Eigenvalues
    \end{itemize}
  \end{frame}
}

\begin{frame}
  \begin{center}
    \includegraphics[width=0.6\textwidth]{figures/png/withoutCRQI}
  \end{center}
\end{frame}

\begin{frame}
  \begin{center}
    \includegraphics[width=0.6\textwidth]{figures/png/withCRQI}
  \end{center}
\end{frame}

\section{Symmetric Eigenvalue Problem}
\begin{frame}
  Compute one eigenpair $(\lambda, \vec{v})$ of symmetric matrix
  $\mat{A}$, \ie
  \begin{equation*}
    \mat{A}\vec{v} = \lambda \vec{v}\,.
  \end{equation*}

  \vspace*{3ex}%
  \begin{theorem}
    \begin{itemize}[label={$\blacktriangleright$}]
    \item The eigenvalues $\lambda_1, \dotsc, \lambda_n$ of
      $\mat{A}$ are real.\\[1em]
    \item The eigenvectors $\vec{v}_1, \dotsc, \vec{v}_n$ of
      $\mat{A}$ are real.\\[1em]
    \item The eigenvectors form an orthogonal basis of\, $\R^n$.
    \end{itemize}
  \end{theorem}
\end{frame}

\begin{frame}
  \begin{algorithm*}[H]
    \setstretch{1.35}%
    \DontPrintSemicolon \KwData{Nonzero unit vector $\vec{x}^{(0)}$}
    \For{$k = 0,1,\dotsc$ until convergence}{
      $\vec{x}^{(k+1)} \gets \mat{A}\vec{x}^{(k)}$\; Normalise
      $\vec{x}^{(k+1)}$\; }
    \caption{Power method}\label{alg:power:method}
  \end{algorithm*}
\end{frame}

\begin{frame}
  \begin{theorem}
    \begin{itemize}[label={$\blacktriangleright$}]
      \setlength\itemsep{1em}
    \item The eigenvalues of $\mat{A}^{-1}$ are
      $\displaystyle \frac{1}{\lambda_i}$.
    \item The eigenvalues of $\mat{A} - \mu\mat{I}$ are
      $\lambda_i - \mu$.  \setlength\itemsep{2em}
    \item The eigenvalues of ${(\mat{A} - \mu\mat{I})}^{-1}$ are
      $\displaystyle \frac{1}{\lambda_i - \mu}$.
    \end{itemize}
  \end{theorem}
\end{frame}

\begin{frame}
  \begin{algorithm*}[H]
    \setstretch{1.35}%
    \DontPrintSemicolon \KwData{Nonzero unit vector $\vec{x}^{(0)}$}
    \For{$k = 0,1,\dotsc$ until convergence}{ Solve
      ${(\mat{A} - \mu \mat{I})}\vec{x}^{(k+1)} = \vec{x}^{(k)}$\;
      Normalise $\vec{x}^{(k+1)}$\; }
    \caption{Shifted Inverse Iteration}
  \end{algorithm*}
\end{frame}

\section{Classic RQI}
\begin{frame}
  Rayleigh Quotient
  \begin{equation*}
    \rq_{\mat{A}}(\vec{x}) = \frac{\vec{x}^\tp  \mat{A} \vec{x}}{\vec{x}^\tp \vec{x}}
    \uncover<2->{
      = \argmin_{\mu \in \C}\norm{\mat{A}\vec{x} - \mu \vec{x}}
    }
  \end{equation*}
\end{frame}

\begin{frame}
  \begin{columns}[t]
    \begin{column}{0.5\textwidth}
      Eigenvector approximation from eigenvalue approximation?
      \\[4ex]
      $\blacktriangleright$\ Shifted Inverse Iteration
    \end{column}%
    \begin{column}{0.5\textwidth}
      Eigenvalue approximation from eigenvector approximation?
      \\[4ex]
      $\blacktriangleright$\ Rayleigh Quotient
    \end{column}
  \end{columns}
  \visible<2->{%
    % \begin{center}
    %   \includegraphics[width=0.2\textwidth]{figures/arrows}
    % \end{center}
    
    \vspace*{1cm}
    \begin{center}
      \begin{tikzpicture}
        \node[inner sep=0pt] at (0,0)%
        {\includegraphics[width=0.25\textwidth]{figures/arrows}};
        \node at (0,0) {RQI};
      \end{tikzpicture}
    \end{center}
  }
\end{frame}

\begin{frame}
  \begin{columns}
    \begin{column}{0.75\textwidth}
      \begin{algorithm*}[H]
        \setstretch{1.35}%
        \DontPrintSemicolon%
        \KwData{Nonzero unit vector $\vec{x}^{(0)}$}
        $\mu^{(0)} \gets {\left(\vec{x}^{(0)}\right)}^\tp \mat{A}
        \vec{x}^{(0)}$ \;%
        \For{$k = 0,1, \dotsc$ until convergence}{%
          Solve
          ${\left( \mat{A} - \mu^{(k)} \mat{I}\right)} \vec{x}^{(k+1)}
          = \vec{x}^{(k)}$ for $\vec{x}^{(k+1)}$\; Normalise
          $\vec{x}^{(k+1)}$\;
          $\mu^{(k+1)} \gets {\left(\vec{x}^{(k+1)}\right)}^\tp
          \mat{A} \vec{x}^{(k+1)}$ \; }
        \caption{Rayleigh Quotient Iteration}
      \end{algorithm*}
    \end{column}
    \begin{column}{0.25\textwidth}
      \begin{equation*}
        \scriptstyle%
        \rq_{\mat{A}}(\vec{x}) = \frac{\vec{x}^\tp  \mat{A} \vec{x}}{\vec{x}^\tp \vec{x}}
      \end{equation*}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}
  \begin{itemize}[label={$\blacktriangleright$}]
    \setlength\itemsep{2em}
  \item Cubic convergence
  \item Converges for almost all starting vectors
  \end{itemize}
  \vspace*{6ex} \visible<2->{
    \begin{block}{\vspace*{-3ex}}
      \begin{center}
        Convergence behaviour can be erratic
      \end{center}
    \end{block}
  }
\end{frame}

\begin{frame}
  \begin{columns}
    \begin{column}{0.4\textwidth}
      \begin{center}
        \includegraphics[width=\textwidth]{figures/png/withCRQI}
      \end{center}
    \end{column}%
    \begin{column}{0.5\textwidth}
      \begin{block}{Observation}
        Convergence depends on initial shift but \textbf{not} initial
        vector
      \end{block}
    \end{column}
  \end{columns}
\end{frame}

\section{Complex RQI}
\begin{frame}
  Suppose $\vec{u} \approx \vec{v}_k$.
  \begin{equation*}
    \mat{A} \quad \longrightarrow \quad \mat{A} - i
    \gamma(\mat{I} - \vec{u} \vec{u}^\tp) \eqqcolon \tilde{\mat{A}}
  \end{equation*}

  \vspace*{3em}%

  % \begin{overprint}[\textwidth]%
  %   \onslide<2>%
  \visible<2->{
    \begin{center}
      \includegraphics[width=\textwidth]{figures/png/perturbed_spectrum}
    \end{center}
  }
  
  % \onslide<3>%
  % Eigenvalues of $\tilde{\mat{A}}$:
  % \begin{equation*}
  %     \tilde{\mat{A}} \vec{v}_k = \mat{A}\vec{v}_k - i \gamma (\vec{v}_k - \vec{u}
  %     \underbrace{\vec{u}^\tp \vec{v}_k}_{\approx 1}) \approx \mat{A} \vec{v}_k = \lambda_k \vec{v}_k\,.
  %   \end{equation*}

  %   \vspace*{1em}%
  %   \begin{align*}
  %     \tilde{\mat{A}} \vec{v}_j = \mat{A}\vec{v}_j - i \gamma (\vec{v}_j - \vec{u}
  %     \underbrace{\vec{u}^\tp \vec{v}_j}_{\approx 0}) &\approx (\mat{A} - i \gamma \mat{I})\vec{v}_j \\
  %                                                     &= (\lambda_j - i\gamma\mat{I})\vec{v}_j \,.
  %   \end{align*}
  % \end{overprint}
\end{frame}

% \begin{frame}
%   \vspace*{2em}
%   \begin{center}
%     \includegraphics[width=\textwidth]{figures/perturbed_spectrum}
%   \end{center}
% \end{frame}

\begin{frame}
  \begin{overprint}[\textwidth]%
    \onslide<1>%
    \begin{algorithm*}[H]
      \DontPrintSemicolon%
      \For{$k = 0,1,\dotsc$ until convergence}{%
        Solve
        $\left( \mat{A} - i \gamma\left(\mat{I} - \vec{u}{\vec{u}}^\tp
          \right) - \mu^{(k)}\mat{I} \right) \vec{x}^{(k+1)} =
        \vec{x}^{(k)}$\; Normalise $\vec{x}^{(k+1)}$\;
        $\mu^{(k+1)} \gets {(\vec{x}^{(k+1)})}^\herm \mat{A}
        \vec{x}^{(k+1)}$\; }
      \caption{Complex RQI (first version)}
    \end{algorithm*}
    \onslide<2>%
    \begin{algorithm*}[H]
      \DontPrintSemicolon%
      \For{$k = 0,1,\dotsc$ until convergence}{%
        Solve
        $\left( \mat{A} - i \gamma^{(k)}\left(\mat{I} - \vec{x}^{(k)}
            {(\vec{x}^{(k)})}^\ast \right) - \mu^{(k)}\mat{I} \right)
        \vec{x}^{(k+1)} = \vec{x}^{(k)}$\; Normalise
        $\vec{x}^{(k+1)}$\;
        $\mu^{(k+1)} \gets {(\vec{x}^{(k+1)})}^\herm \mat{A}
        \vec{x}^{(k+1)}$\;
        $\gamma^{(k+1)} \gets \norm*{(\mat{A} - \mu^{(k+1)}\mat{I})
          \vec{x}^{(k+1)}}$\; }
      \caption{Complex RQI (first version)}
    \end{algorithm*}
  \end{overprint}
\end{frame}

\begin{frame}
  \begin{theorem}
    It suffices to use
    \begin{equation*}
      \tilde{\mat{A}} = \mat{A} - i \gamma^{(k)} \mat{I}
    \end{equation*}
    instead of
    \begin{equation*}
      \tilde{\mat{A}} = \mat{A} - i \gamma^{(k)} (\mat{I} - \vec{x}^{(k)} {(\vec{x}^{(k)})}^\ast)\,.
    \end{equation*}
  \end{theorem}
\end{frame}

\begin{frame}
  \begin{algorithm*}[H]
    \DontPrintSemicolon%
    \KwData{Nonzero unit vector $\vec{x}^{(0)}$}
    $\mu^{(0)} \gets {(\vec{x}^{(0)})}^\tp \mat{A} \vec{x}^{(0)}$\;
    $\gamma^{(0)} \gets \norm*{(\mat{A} - \mu^{(0)}\mat{I})
      \vec{x}^{(0)}}$\;
    $\sigma^{(0)} \gets \mu^{(0)} + i \gamma^{(0)}$\;
    \For{$k = 0,1,\dotsc$ until convergence}{ Solve
      $( \mat{A} - \sigma^{(k)}\mat{I}) \vec{x}^{(k+1)} =
      \vec{x}^{(k)}$\; Normalise $\vec{x}^{(k+1)}$\;
      $\mu^{(k+1)} \gets {(\vec{x}^{(k+1)})}^\herm \mat{A}
      \vec{x}^{(k+1)}$\;
      $\gamma^{(k+1)} \gets \norm*{(\mat{A} - \mu^{(k+1)}\mat{I})
        \vec{x}^{(k+1)}}$\;
      $\sigma^{(k+1)} \gets \mu^{(k+1)} + i \gamma^{(k+1)}$\; }
    $\vec{x} \gets \operatorname{Re}({\vec{x}^{(k+1)}})$\;
    $\vec{x} \gets \vec{x} / \norm*{\vec{x}}$\;
    $\mu \gets \vec{x}^\tp \mat{A} \vec{x}$
    \caption{Complex Rayleigh Quotient Iteration}
  \end{algorithm*}
\end{frame}

\begin{frame}
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{center}
        \includegraphics[width=0.95\textwidth]{figures/png/angles1}
      \end{center}
    \end{column}%
    \begin{column}{0.5\textwidth}
      \begin{center}
        \includegraphics[width=0.95\textwidth]{figures/png/angles2}
      \end{center}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}
  \begin{center}
    \includegraphics[width=0.7\textwidth]{figures/png/residuals}
  \end{center}
\end{frame}

\begin{frame}
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{center}
        \includegraphics[width=0.95\textwidth]{figures/png/its1}
      \end{center}
    \end{column}%
    \begin{column}{0.5\textwidth}
      \begin{center}
        \includegraphics[width=0.95\textwidth]{figures/png/its2}
      \end{center}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{Summary}
  \begin{itemize}[label={$\blacktriangleright$}]
    \setlength\itemsep{1em}
  \item Unpredictability of classic RQI
  \item Complex RQI succeeds for error angles below
    45${}^\circ$
  \item More iterations than classic RQI but still fast
  \end{itemize}
  \pause%
  \vspace*{3em}
  \begin{itemize}[label={$\blacktriangleright$}]
    \setlength\itemsep{1em}
  \item Theoretical analysis
  \item Other test problems
  \end{itemize}
\end{frame}

\begin{frame}
  
\end{frame}

\begin{frame}
  Write
  $\tilde{\mat{A}} = \mat{A} - i \gamma(\mat{I} - \vec{u} \vec{u}^\tp)
  =\tilde{\mat{A}}_{(0)} + \tilde{\mat{A}}_{(1)}$ with
  \begin{align*}
    \tilde{\mat{A}}_{(0)} &\coloneqq \mat{A} - i \gamma(\mat{I}- \vec{v}_k \vec{v}_k^\tp)\\[1em]
    \tilde{\mat{A}}_{(1)} &\coloneqq i \gamma ( \vec{u} \vec{u}^\tp - \vec{v}_k\vec{v}_k^\tp)
  \end{align*}
  \pause%
  \begin{theorem}
    \begin{equation*}
      \lambda_j(\tilde{\mat{A}}) =
      \lambda_j(\mat{A}) + i \gamma\left({\langle \vec{v}_j, \vec{u} \rangle}^2 - 1\right)
      + \mathcal{O}\left(
        \norm{\tilde{\mat{A}}_{(1)}}^2
      \right)\,,
    \end{equation*}
    where
    \begin{equation*}
      \norm{\tilde{\mat{A}}_{(1)}} = \gamma \sqrt{1 - {\langle \vec{u}, \vec{v}_k \rangle}^2}\,.
    \end{equation*}
  \end{theorem}
\end{frame}
 
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
